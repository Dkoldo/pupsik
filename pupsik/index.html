<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Pupsik Wordle</title>

<link rel="manifest" href="manifest.webmanifest">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<link rel="apple-touch-icon" href="icons/icon-192.png">

<style>
  :root{
    --bg:#ffedf3;           /* pinky background */
    --tile:#f8cfe0; 
    --text:#5a2141;
    --absent:#bfa3b1;
    --present:#f2c14e;      /* yellow */
    --correct:#6aaa64;      /* green */
    --key:#e8b9cc; 
    --key-text:#41142d;
    --accent:#c77fa2;
  }
  *{box-sizing:border-box;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial}
  body{margin:0;background:var(--bg);color:var(--text);display:flex;flex-direction:column;align-items:center;gap:10px;min-height:100svh;overflow-x:hidden}
  header{letter-spacing:.08em;font-weight:800;border-bottom:2px dashed var(--accent);width:100%;text-align:center;padding:12px 0;position:relative}
  header .emo{position:absolute;top:8px;font-size:22px}
  header .l{left:10px} header .r{right:10px}

  /* floating hearts/babies */
  .float{position:fixed;pointer-events:none;opacity:.15;font-size:48px;animation:drift 18s linear infinite}
  .f1{left:5%;bottom:10%} .f2{left:20%;bottom:30%;animation-duration:22s}
  .f3{left:40%;bottom:15%;animation-duration:26s}
  .f4{right:12%;bottom:20%;animation-duration:21s}
  @keyframes drift{0%{transform:translateY(0)}100%{transform:translateY(-120vh)}}

  #bar{display:flex;gap:10px;align-items:center;flex-wrap:wrap;justify-content:center}
  #msg{min-height:24px;font-weight:700}
  #stats{font-variant-numeric:tabular-nums;opacity:.8}
  button{background:var(--accent);color:#fff;border:none;padding:8px 12px;border-radius:8px;font-weight:700}

  #board{display:grid;gap:6px;margin-top:10px}
  .row{display:grid;grid-template-columns:repeat(5,1fr);gap:6px}
  .tile{
    width:min(62px,14.5vw);height:min(62px,14.5vw);
    border:2px solid #d6a3bd;display:flex;align-items:center;justify-content:center;
    font-weight:800;font-size:clamp(20px,6vw,32px);text-transform:uppercase;background:#ffe8f0;border-radius:10px;
  }
  .tile.filled{border-color:#c989ad}
  .tile.absent{background:var(--absent);border-color:var(--absent);color:#fff}
  .tile.present{background:var(--present);border-color:var(--present);color:#fff}
  .tile.correct{background:var(--correct);border-color:var(--correct);color:#fff}
  .shake{animation:shake .2s 2}
  @keyframes shake{0%{transform:translateX(0)}25%{transform:translateX(-6px)}75%{transform:translateX(6px)}100%{transform:translateX(0)}}

  #kb{display:grid;grid-template-columns:repeat(20,1fr);gap:6px;max-width:720px;width:100%;padding:8px}
  .key{grid-column:span 2;background:var(--key);color:var(--key-text);border:none;padding:10px 0;border-radius:8px;font-weight:700}
  .key.wide{grid-column:span 3}
  .key.used{filter:saturate(.85);opacity:.95}
  footer{height:20px}
</style>
</head>
<body>
  <span class="float f1">‚ù§Ô∏è</span><span class="float f2">üë∂</span>
  <span class="float f3">üíñ</span><span class="float f4">üë∂</span>

  <header>
    <span class="emo l">üíû</span>
    PUPSIK WORDLE
    <span class="emo r">üë∂</span>
  </header>

  <div id="bar">
    <div id="msg"></div>
    <div id="stats"></div>
    <button id="new" title="Next word">‚è≠ Next</button>
  </div>

  <div id="board"></div>
  <div id="kb"></div>
  <footer></footer>

<script>
/* ----------------- SETTINGS ----------------- */
const WORD_LENGTH = 5;
const MAX_GUESSES = 6;

/* Biggish answer list (edit freely‚Äîkeep 5 letters, lowercase) */
const ANSWERS = [
"apple","candy","steam","music","smile","brave","pearl","plant","spice","charm",
"sweet","flirt","spoon","storm","water","honey","gloss","laugh","shine","dream",
"toast","cocoa","tiger","lemon","grape","blush","clean","chair","sugar","light",
"spark","grace","fresh","crisp","daisy","petal","caffe","cookie","pasta","angel",
"cheer","magic","bloom","flame","berry","proud","cloud","heart","kissy","pinky",
"poppy","tulip","rosey","bunny","kitty","puppy","cupid","peach","mango","berry",
"cabin","cozyy","snack","spicy","salty","silly","happy","giggle","sweet","snugg",
"nifty","plush","softy","fizzy","jazzy","sugar","lemon","melon","cider","fairy",
"paris","tokyo","vienn","brest","minsk","rigaa","kyoto","sofia","milan","osaka",
"river","ocean","shore","beach","sunny","rainy","stars","moony","space","orbit"
].filter(w=>w.length===5);

/* Valid guesses; keep it simple (answers only). */
const VALID = new Set(ANSWERS);

/* -------------- State & helpers -------------- */
let pool = [...ANSWERS];
let secret = "";
let row = 0, col = 0;
let board = [];
let locked = false;

const el = s => document.querySelector(s);
const msg = t => { el("#msg").textContent = t || ""; };
const saveStats = (win) => {
  const k = "pup_stats";
  const s = JSON.parse(localStorage.getItem(k) || '{"played":0,"wins":0,"streak":0,"best":0}');
  s.played++; if (win){ s.wins++; s.streak++; s.best = Math.max(s.best, s.streak); } else { s.streak=0; }
  localStorage.setItem(k, JSON.stringify(s)); renderStats();
};
const renderStats = () => {
  const s = JSON.parse(localStorage.getItem("pup_stats") || '{"played":0,"wins":0,"streak":0,"best":0}');
  el("#stats").textContent = `Played ${s.played} ¬∑ Wins ${s.wins} ¬∑ Streak ${s.streak} ¬∑ Best ${s.best}`;
};

/* -------------- UI build -------------- */
function buildBoard(){
  const b = el("#board");
  b.innerHTML = "";
  b.style.gridTemplateRows = `repeat(${MAX_GUESSES}, 1fr)`;
  for(let r=0;r<MAX_GUESSES;r++){
    const rowDiv = document.createElement("div");
    rowDiv.className = "row";
    for(let c=0;c<WORD_LENGTH;c++){
      const tile = document.createElement("div");
      tile.className = "tile";
      rowDiv.appendChild(tile);
    }
    b.appendChild(rowDiv);
  }
}
function buildKeyboard(){
  const layout = [
    ..."qwertyuiop".split(""),
    ..."asdfghjkl".split(""),
    "Enter", ..."zxcvbnm".split(""), "‚Üê"
  ];
  const kb = el("#kb"); kb.innerHTML = "";
  const rowBreaks = [10, 19];
  layout.forEach((k,i)=>{
    const btn = document.createElement("button");
    btn.className = "key";
    btn.textContent = k === "‚Üê" ? "Back" : k;
    if (k === "Enter") btn.classList.add("wide");
    btn.onclick = () => onKey(k);
    kb.appendChild(btn);
    if (rowBreaks.includes(i)) {
      const spacer = document.createElement("div"); spacer.style.gridColumn = "1 / -1";
      kb.appendChild(spacer);
    }
  });
}
function setTile(r,c,ch,cls=""){
  const tile = el("#board").children[r].children[c];
  tile.textContent = ch || "";
  tile.className = "tile" + (ch ? " filled" : "") + (cls ? " " + cls : "");
}

/* -------------- Game flow -------------- */
function pickSecret(){
  if (pool.length === 0) pool = [...ANSWERS];
  secret = pool.splice(Math.floor(Math.random()*pool.length),1)[0];
}
function startRound(){
  locked = false; msg(""); row=0; col=0; board = Array.from({length:MAX_GUESSES},()=>Array(WORD_LENGTH).fill(""));
  buildBoard(); buildKeyboard(); renderStats();
}
function finish(win){
  locked = true;
  saveStats(win);
  msg(win ? "You win, Pupsik! üíñ Tap Next." : `The word was ‚Äú${secret}‚Äù. Tap Next.`);
}
function submitRow(){
  const guess = board[row].join("");
  if (guess.length < WORD_LENGTH){ rowShake(); return msg("Not enough letters."); }
  if (!VALID.has(guess)) { rowShake(); return msg("Not in list."); }

  const s = secret.split("");
  const res = Array(WORD_LENGTH).fill("absent");

  for (let i=0;i<WORD_LENGTH;i++){
    if (guess[i] === s[i]){ res[i] = "correct"; s[i] = null; }
  }
  for (let i=0;i<WORD_LENGTH;i++){
    if (res[i] === "correct") continue;
    const idx = s.indexOf(guess[i]);
    if (idx > -1){ res[i] = "present"; s[idx] = null; }
  }

  for (let i=0;i<WORD_LENGTH;i++){
    setTile(row,i,guess[i],res[i]);
    paintKey(guess[i],res[i]);
  }

  if (guess === secret){
    // special message every time she solves a word
    msg("You win, Pupsik! üë∂üíñ");
    return finish(true);
  }
  row++; col=0;
  if (row === MAX_GUESSES) finish(false);
}
function paintKey(ch, cls){
  const key = [...document.querySelectorAll(".key")].find(b=>b.textContent.toLowerCase()===ch);
  if (!key) return;
  key.classList.add("used");
  const rank = {absent:1,present:2,correct:3};
  const current = key.dataset.state || "none";
  if (rank[cls] > (rank[current]||0)) {
    key.dataset.state = cls;
    const rs = getComputedStyle(document.documentElement);
    if (cls==="absent") key.style.background = rs.getPropertyValue("--absent");
    if (cls==="present") key.style.background = rs.getPropertyValue("--present");
    if (cls==="correct") key.style.background = rs.getPropertyValue("--correct");
  }
}
function rowShake(){
  const r = el("#board").children[row];
  r.classList.add("shake"); setTimeout(()=>r.classList.remove("shake"),300);
}

/* -------------- Input -------------- */
function onKey(k){
  if (locked) return;
  if (k === "Enter") return submitRow();
  if (k === "‚Üê" || k === "Backspace"){
    if (col>0){ col--; board[row][col] = ""; setTile(row,col,""); }
    return;
  }
  const ch = String(k).toLowerCase();
  if (/^[a-z]$/.test(ch) && col < WORD_LENGTH){
    board[row][col] = ch;
    setTile(row,col,ch);
    col++;
  }
}
document.addEventListener("keydown",(e)=>{
  if (e.key === "Enter" || e.key === "Backspace") { e.preventDefault(); onKey(e.key); }
  else if (/^[a-zA-Z]$/.test(e.key)) onKey(e.key);
});
el("#new").onclick = () => { pickSecret(); startRound(); };

/* -------------- Boot -------------- */
if ("serviceWorker" in navigator) { navigator.serviceWorker.register("./sw.js"); }
pickSecret(); startRound();
</script>
</body>
</html>
